<!DOCTYPE html>
<html>
<head>
    <meta charset='utf-8' />
    <title></title>
    <meta name='viewport' content='initial-scale=1,maximum-scale=1,user-scalable=no' />
    <script src='https://api.tiles.mapbox.com/mapbox-gl-js/v0.29.0/mapbox-gl.js'></script>
    <link href='https://api.tiles.mapbox.com/mapbox-gl-js/v0.29.0/mapbox-gl.css' rel='stylesheet' />
    <style>
        body { margin:0; padding:0; }
        #map { position:absolute; top:0; bottom:0; width:100%; }
    </style>

</head>
<body>

<style>
.mapboxgl-popup {
    max-width:200px;
}
.mapboxgl-popup h1{
    margin: 5px 0;
}
.mapboxgl-popup h3{
    margin: 0;
}
</style>



<div id='map'></div>
<script>
mapboxgl.accessToken = 'pk.eyJ1IjoiY2hhdXBvdyIsImEiOiJZX29XRnNFIn0.5eui1ITuIWOxZdPyF0kWTA';

var geojson = {
    "type": "FeatureCollection",
    "features": [
        {
      "type": "Feature",
      "properties": {
        "Name": "Cafe Bibliotic Hello",
        "NameJp": "Cafe Bibliotic Hello",
        "Description": "My second favourite cafe. Western pasta and stuff. There's a bakery next to it. You can buy some delicious stuff there and tell them that you would like to eat in the cafe."
      },
      "geometry": {
        "coordinates": [
          135.764162,
          35.01372
        ],
        "type": "Point"
      },
      "id": "039243914e78f5ce42094eb49925b35d"
    },
    {
      "type": "Feature",
      "properties": {
        "Name": "Delta",
        "NameJp": "デルタ",
        "Description": "Enjoy Kamogawa. Grab some alcohol (e.g. Umeshu 梅酒 or Horoyoi ほろよい) and chill here. You'll likely see other Kyoudai students here."
      },
      "geometry": {
        "coordinates": [
          135.771786,
          35.03015
        ],
        "type": "Point"
      },
      "id": "1f01f21c71c8ac95c6791d8f1a29b099"
    },
    {
      "type": "Feature",
      "properties": {
        "Name": "Moan",
        "NameJp": "茂庵",
        "Description": "Fanciest Cafe ever. A little bit overpriced but this cafe is totally worth it. Good for a tea/coffee break or lunch."
      },
      "geometry": {
        "coordinates": [
          135.787099,
          35.026301
        ],
        "type": "Point"
      },
      "id": "22610e077e6b6b1c3ffcecce4ecc6502"
    },
    {
      "type": "Feature",
      "properties": {
        "Name": "Katte",
        "NameJp": "Katte",
        "Description": "One of my favourite Cafes. If you fancy some cake. Come here. "
      },
      "geometry": {
        "coordinates": [
          135.769541,
          35.021343
        ],
        "type": "Point"
      },
      "id": "2bd441855cf65823832f06954e5979e5"
    },
    {
      "type": "Feature",
      "properties": {
        "Name": "Shizuku Cafe",
        "NameJp": "シズク",
        "Description": "A very very lovely cafe. If Moan is not your cup of tea for lunch, try Shizuku. Opening times can be tricky, better do some research beforehand."
      },
      "geometry": {
        "coordinates": [
          135.788241,
          35.029436
        ],
        "type": "Point"
      },
      "id": "2c803d449ca709fd063bf611b7f60b3b"
    },
    {
      "type": "Feature",
      "properties": {
        "Name": "Kyoto University's Clock Tower",
        "NameJp": "京大時計台",
        "Description": "Kyoto University's Clock Tower. Japan's second best university."
      },
      "geometry": {
        "coordinates": [
          135.780923,
          35.026211
        ],
        "type": "Point"
      },
      "id": "30c28b67d0cfc489685a80fa6894b647"
    },
    {
      "type": "Feature",
      "properties": {
        "Name": "Takumi",
        "NameJp": "たく味",
        "Description": "My favourite Tonkotsu Ramen"
      },
      "geometry": {
        "coordinates": [
          135.777542,
          35.028866
        ],
        "type": "Point"
      },
      "id": "767636bc10836d8969e9241128f7e5a4"
    },
    {
      "type": "Feature",
      "properties": {
        "Name": "Daikoji Temple?",
        "NameJp": "大興寺",
        "Description": "Some random temple. Walking down Yoshida Hill, there is a nice temple. I was there several times but I'm not really sure whether this location is correct of whether Daikoji is really its name. :D"
      },
      "geometry": {
        "coordinates": [
          135.787889,
          35.023138
        ],
        "type": "Point"
      },
      "id": "774be6e55ef2c3cbd8be6bcd237535f5"
    },
    {
      "type": "Feature",
      "properties": {
        "Name": "Yoshida Dormitory",
        "NameJp": "吉田寮",
        "Description": "Kyoto University's Dormitory. It is more or less self-organized, quite left-winged and pretty fucked up. Monthly rent is about 4000yen (40€) . It is a one-of a kind experience"
      },
      "geometry": {
        "coordinates": [
          135.779856,
          35.022429
        ],
        "type": "Point"
      },
      "id": "84747fc840933a61ac9063609f5f4ab4"
    },
    {
      "type": "Feature",
      "properties": {
        "Name": "Yoshida Shrine",
        "NameJp": "吉田神社",
        "Description": "Yoshida Shrine and Yoshida Hill . Great for an awesome walk, fleeing the hustle and bustle of crowded Kyoto"
      },
      "geometry": {
        "coordinates": [
          135.784803,
          35.024369
        ],
        "type": "Point"
      },
      "id": "b31ac103e66c5ce7b1f70f4dd8df171e"
    },
    {
      "type": "Feature",
      "properties": {
        "Name": "Hike up Daimonji",
        "NameJp": "大文字山登ろう！",
        "Description": "If you're up for a nice (~30min) hike, turn left at Ginkakuji and hike up Daimonji. "
      },
      "geometry": {
        "coordinates": [
          135.797626,
          35.027771
        ],
        "type": "Point"
      },
      "id": "c6903b5aa28b7df5a87a296d05cde586"
    }
    ]
};

var map = new mapboxgl.Map({
    container: 'map', // container id
    style: 'mapbox://styles/chaupow/cix9gllrr00dl2qnva21cs4w1', //stylesheet location
    center: [135.781587, 35.023475], // starting position 35.020711/-224.218011
    zoom: 14.5 // starting zoom
});

map.on('load', function () {

    map.addSource('places', {
       type: 'geojson',
       data: geojson
    });

    // Add a layer showing the places.
    map.addLayer({
        "id": "places",
        "source": "places",
        "type": "circle",
        "paint": {
            "circle-opacity": 0.05,
            "circle-radius": 20,
        }
    });

});


map.on('click', function (e) {
    var features = map.queryRenderedFeatures(e.point, { layers: ['places'] });


    if (!features.length) {
        console.log('nay'+e);
        return;
    }
    console.log('yai');

    var feature = features[0];

    var popup = new mapboxgl.Popup()
    .setLngLat(feature.geometry.coordinates)
    .setHTML('<h1>'+feature.properties.Name+'</h1>'+
        '<h3>'+feature.properties.NameJp+'</h3>'+
        feature.properties.Description)
    .addTo(map);
});

</script>

</body>
</html>
